EXTVAR
STOREVAR
VAR
CONST
DEFINE

sanityCheck := (sti.exitStatus = normal & ((PE = sti.b1 & sti.vm = 0 & sti.iopl < cpl & cpl = 0x3 & PVI = sti.b1) | (PE = sti.b1 & sti.vm = 1 & sti.iopl < 0x3 & sti.vip = sti.b0 & VME = sti.b1))) =>
				(sti.rflags # [18:18] = sti.b1);

EXEC
initialize;
simulate(1);
print(sti.exitStatus);
decide(sanityCheck);