EXTVAR
STOREVAR
VAR
CONST
DEFINE

(*On non-normal exit final vars must be equal to initial vars*)
earlyExit := (sysret.exitStatus != normal) =>
				((sysret.cs = CS_I) & (sysret.ss = SS_I) & (sysret.rflags = RFLAGS_I) & (sysret.rip = RIP_I));


sysretBug := (~sysret.exit) =>
				(sysret.cpl = 3);

EXEC
initialize;
print(sysret.rip);
simulate(1);
print(sysret.rip);
